@model List<MenuViewModel>

@{
    ViewBag.Title = "Menu List";

    Layout = "~/Views/AdminLayout/Index.cshtml";
}

<h2>Menu List</h2>

<div class="container">
    <div class="row">
        @foreach (var menu in Model)
        {
            <div class="col-md-4">
                <div class="card mb-4 shadow-sm">
                    <div class="card-body">
                        <h5 class="card-title">@menu.Name</h5>
                        <p class="card-text">@menu.Description</p>
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="btn-group">
                                <button type="button" class="btn btn-sm btn-outline-secondary btnAdd" data-id="@menu.Id">Add</button>
                            </div>
                            <small class="text-muted">@menu.Price $</small>


                            <form asp-action="AddToBasket" method="POST" style="display:inline">

                                <input type="hidden" name="Id" value="@menu.Id" />
                                <input type="hidden" name="Name" value="@menu.Name" />
                                <input type="hidden" name="HamburgerId" value="@menu.HamburgerId" />
                                <input type="hidden" name="DrinkId" value="@menu.DrinkId" />
                                <input type="hidden" name="Quantity" value="@menu.Quantity" />
                                <input type="hidden" name="Price" value="@menu.Price" />
                                <input type="hidden" name="HamburgerViewModel" value="@menu.HamburgerViewModel" />

                                <button type="submit" class="btn btn-outline-primary btn-sm me-2">

                                    <i class="bi bi-hand-thumbs-up"></i> Sepete Ekle

                                </button>

                            </form>


                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="addModal" tabindex="-1" aria-labelledby="addModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addModalLabel">Add Garnitures and Drink</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="addForm">
                    <div class="form-group">
                        <label for="garnitures">Garnitures</label>
                        <select multiple class="form-control" id="garnitures">
                            <!-- Garniture options will be populated here -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="drink">Drink</label>
                        <select class="form-control" id="drink">
                            <!-- Drink options will be populated here -->
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="saveSelection">Save</button>
            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
<script>
    $(document).ready(function () {
        $(".btnAdd").click(function () {
            var menuId = $(this).data("id");

            // Populate garniture options
            $("#garnitures").empty();
            $.ajax({
                url: '@Url.Action("GetGarnitures", "Menu")',
                method: 'GET',
                success: function (data) {
                    $.each(data, function (i, item) {
                        $("#garnitures").append($('<option>', {
                            value: item.Id,
                            text: item.Name
                        }));
                    });
                }
            });

            // Populate drink options
            $("#drink").empty();
            $.ajax({
                url: '@Url.Action("GetDrinks", "Menu")',
                method: 'GET',
                success: function (data) {
                    $.each(data, function (i, item) {
                        $("#drink").append($('<option>', {
                            value: item.Id,
                            text: item.Name
                        }));
                    });
                }
            });

            $("#addModal").modal('show');
        });

        $("#saveSelection").click(function () {
            var selectedGarnitures = $("#garnitures").val();
            var selectedDrink = $("#drink").val();

            // Here you can handle the selected garnitures and drink
            console.log("Selected Garnitures: " + selectedGarnitures);
            console.log("Selected Drink: " + selectedDrink);

            $("#addModal").modal('hide');
        });
    });
</script>
