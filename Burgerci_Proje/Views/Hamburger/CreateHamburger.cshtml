@model HamburgerViewModel
@{
    ViewData["Title"] = "CreateHamburger";
    Layout = "~/Views/AdminLayout/Index.cshtml";
}

<h2>Create Hamburger</h2>

<form asp-action="CreateHamburger" method="post">
    <div class="form-group">
        <label asp-for="Name"></label>
        <input asp-for="Name" class="form-control" />
    </div>
    <div class="form-group">
        <label asp-for="Description"></label>
        <textarea asp-for="Description" class="form-control"></textarea>
    </div>
    <div class="form-group">
        <label asp-for="Price"></label>
        <input asp-for="Price" class="form-control" />
    </div>
    <div data-mdb-input-init class="form-group form-outline mb-4">
        <label asp-for="ImageUrl" class="form-label">ADD PHOTO</label>
        <input asp-for="ImageUrl" class="form-control form-control-lg" type="file" id="ImageUrl" />
    </div>
    <div class="form-group">
        <label>Garnitures</label>
        <div>
            @foreach (var garniture in ViewBag.Garnitures as List<GarnitureViewModel>)
            {
                <div class="form-check">
                    <input type="checkbox" class="form-check-input" id="garniture_@garniture.Id" name="SelectedGarnitureIds" value="@garniture.Id" />
                    <label class="form-check-label" for="garniture_@garniture.Id">
                        @garniture.Name
                    </label>
                </div>
            }
        </div>
    </div>
    <button type="submit" class="btn btn-primary">Save</button><div class="modal fade" id="garnitureModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Select Garnitures</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <!-- Garniture checkboxes will be loaded here -->
                    <div id="garnitureList">
                        <!-- Example Checkbox -->
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="garniture_1" value="1" />
                            <label class="form-check-label" for="garniture_1">Garniture 1</label>
                        </div> -->
                    </div>
                    <div id="drinkList">
                        <!-- Example Single Select -->
                        <div class="form-check">
                            <input type="radio" class="form-check-input" id="drink_1" name="selectedDrink" value="1" />
                            <label class="form-check-label" for="drink_1">Drink 1</label>
                        </div> -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>
@* 
@section Scripts {
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
} *@
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script>
    $(document).ready(function () {
        // Open modal on button click
        $("#btnAdd").click(function () {
            $('#garnitureModal').modal('show');
            loadGarnitures();
            loadDrinks();
        });

        // Load garnitures via AJAX
        function loadGarnitures() {
            $.ajax({
                url: '@Url.Action("GetGarnitures", "YourController")', // Adjust this URL as needed
                type: 'GET',
                success: function (data) {
                    let garnitureList = $('#garnitureList');
                    garnitureList.empty(); // Clear previous items
                    data.forEach(function (garniture) {
                        garnitureList.append(
                            `<div class="form-check">
                                <input type="checkbox" class="form-check-input" id="garniture_${garniture.id}" value="${garniture.id}" />
                                <label class="form-check-label" for="garniture_${garniture.id}">${garniture.name}</label>
                            </div>`
                        );
                    });
                },
                error: function (error) {
                    console.error('Error loading garnitures:', error);
                }
            });
        }

        // Load drinks via AJAX
        function loadDrinks() {
            $.ajax({
                url: '@Url.Action("GetDrinks", "YourController")', // Adjust this URL as needed
                type: 'GET',
                success: function (data) {
                    let drinkList = $('#drinkList');
                    drinkList.empty(); // Clear previous items
                    data.forEach(function (drink) {
                        drinkList.append(
                            `<div class="form-check">
                                <input type="radio" class="form-check-input" id="drink_${drink.id}" name="selectedDrink" value="${drink.id}" />
                                <label class="form-check-label" for="drink_${drink.id}">${drink.name}</label>
                            </div>`
                        );
                    });
                },
                error: function (error) {
                    console.error('Error loading drinks:', error);
                }
            });
        }

        // Save selected garnitures and drink
        $("#saveSelections").click(function () {
            let selectedGarnitures = [];
            $('input[name="SelectedGarnitureIds"]:checked').each(function () {
                selectedGarnitures.push($(this).val());
            });

            let selectedDrink = $('input[name="selectedDrink"]:checked').val();

            // You can handle the selected values here, e.g., send them to the server via AJAX
            console.log('Selected Garnitures:', selectedGarnitures);
            console.log('Selected Drink:', selectedDrink);

            // Close modal
            $('#garnitureModal').modal('hide');
        });
    });

</script>

